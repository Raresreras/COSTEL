<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta charset="utf-8">

    <!-- Check and update for the latest bootstrap version -->    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <style>
        .square {
            height: 400px;
            width: 80%;
            background-color: #555;
            margin: 10px;
        }
    </style>

    <title>COSTEL</title>
</head>
<div class="container-fluid p-0">
    <nav class="navbar navbar-dark bg-dark">
        <span class="navbar-text p-2">
            COSTEL
        </span>
    </nav>
    <div class="container-fluid">
        <div class="card m-4">
            <div class="card-header bg-primary">
                <h1 class="text-white">Intrebare</h1>
            </div>
            <div class="card-body bg-dark">

            </div>
        </div>
        <div class="card m-4">
            <div class="card-body" style="display: flex; justify-content: center;">
                <div class="square" id="question_square" style="background-color: coral;"></div>
            </div>
            <div class="card-body">
                <h6 class="text">Log data</h6>
                <h6 class="text" id="question">Awaiting question</h6>
            </div>
        </div>
    </div>
        <script>
            async function sleep(ms) {
                await new Promise((resolve) => setTimeout(resolve, ms));
            }

            let socket = new WebSocket('ws://localhost:8000');
            // Handle open event
            socket.addEventListener('open', () => {
                console.log('Connected to WebSocket server');
            });
            // Handle message event
            socket.addEventListener('message', async (event) => {
                console.log('Message from server:', JSON.stringify(event.data));
                document.getElementById('question').innerHTML = event.data;

                // Changing square color and stopping communcation for 5 seconds
                if (document.getElementById('question_square').style.backgroundColor == 'coral')
                    document.getElementById('question_square').style.backgroundColor = event.data;
                    await sleep(5000);
                    document.getElementById('question_square').style.backgroundColor = 'coral';
            });
            // Handle close event
            socket.addEventListener('close', () => {
                console.log('WebSocket connection closed');
            });
        </script>
    </div>
</div>
</html>